{% extends "global/Page.html" %}
{% load otree %}

{% block title %}Task 1. Part 1: Finding the 2 Numbers forming a sum{% endblock %}

{% block content %}

<h5><strong>Please find the two numbers that sum up to <i id="target"></i></strong></h5>

<style>
    table {
        width: 60%;
        margin-left:auto;
        margin-right:auto;
        border: 2px solid rgb(36, 126, 243);
        /*border-collapse: collapse;*/
    }
    th, td {
        text-align: center;
        height: 50px;
        border: 2px solid rgb(36, 126, 243);
        border-collapse: collapse;
    }
    td:hover {
        background-color: azure;
    }
    .buttonHolder{
        text-align: center;
    }
</style>

<div class="QuestionDIV">
    <table>
        <tr>
            <td> <input type="checkbox" id="cell1" name="number" onchange="cbChange(this)">
                 <label for="cell1" id="num1"></label>
            </td>
            <td> <input type="checkbox" id="cell2" name="number" onchange="cbChange(this)">
                 <label for="cell2" id="num2"></label>
            </td>
            <td> <input type="checkbox" id="cell3" name="number" onchange="cbChange(this)">
                 <label for="cell3" id="num3"></label>
            </td>
        </tr>
        <tr>
            <td> <input type="checkbox" id="cell4" name="number" onchange="cbChange(this)">
                 <label for="cell4" id="num4"></label>
            </td>
            <td> <input type="checkbox" id="cell5" name="number" onchange="cbChange(this)">
                 <label for="cell5" id="num5"></label>
            </td>
            <td> <input type="checkbox" id="cell6" name="number" onchange="cbChange(this)">
                 <label for="cell6" id="num6"></label>
            </td>
        </tr>
        <tr>
            <td> <input type="checkbox" id="cell7" name="number" onchange="cbChange(this)">
                 <label for="cell7" id="num7"></label>
            </td>
            <td> <input type="checkbox" id="cell8" name="number" onchange="cbChange(this)">
                 <label for="cell8" id="num8"></label>
            </td>
            <td> <input type="checkbox" id="cell9" name="number" onchange="cbChange(this)">
                 <label for="cell9" id="num9"></label>
            </td>
        </tr>
    </table>
    <p>
        <div class="buttonHolder">
            <input type="submit" id="check_button" value="Submit" >
            <input type="hidden" name="nr_correct_1" id="Task1Correct" />
        </div>
    </p>
</div>

<script type="text/javascript">
    var score = 0
    var task1_score = document.getElementById("Task1Correct");
    var matrices1 = [38,44,89,67,23,39,12,96,17,
                     38,86,17,70,31,53,76,68,22,
                     17,28,64,28,69,84,18,53,21,
                     38,52,32,40,76,31,76,54,12,
                     13,42,17,74,70,52,84,10,90,
                     48,30,78,20,60,86,66,68,55,
                     22,62,17,23,35,81,40,70,24,
                     38,52,66,33,83,51,44,32,68,
                     82,22,47,78,82,31,47,51,14,
                     30,70,51,15,37,42,12,20,40,
                     17,28,16,62,47,39,14,87,97,
                     52,33,70,59,95,30,71,79,19,
                     52,37,40,80,37,48,47,16,90,
                     63,30,39,43,83,68,62,16,44,
                     68,92,75,71,88,78,21,72,70,
                     84,49,82,75,43,46,64,70,68,
                     51,93,53,94,40,80,35,54,71,
                     59,17,13,10,55,66,79,21,97,
                     85,44,50,64,95,85,83,45,42,
                     79,87,23,54,18,53,50,10,56,
                     66,38,98,57,57,17,40,50,39,
                     42,13,97,72,30,63,40,91,92,
                     17,53,48,34,88,71,83,58,25,
                     55,97,28,72,46,96,27,65,48,
                     75,11,68,35,94,42,41,13,15,
                     59,24,44,76,35,62,44,39,50,
                     85,34,81,36,31,37,72,64,65,
                     19,30,24,30,36,85,11,92,30,
                     11,89,25,14,75,20,11,98,98,
                     67,96,92,12,72,13,49,27,71]

    var j = 0

    var num1 = matrices1.slice(j,j+1)
    var num2 = matrices1.slice(j+1,j+2)
    var num3 = matrices1.slice(j+2,j+3)
    var num4 = matrices1.slice(j+3,j+4)
    var num5 = matrices1.slice(j+4,j+5)
    var num6 = matrices1.slice(j+5,j+6)
    var num7 = matrices1.slice(j+6,j+7)
    var num8 = matrices1.slice(j+7,j+8)
    var num9 = matrices1.slice(j+8,j+9)

    document.getElementById("num1").innerHTML = num1
    document.getElementById("num2").innerHTML = num2
    document.getElementById("num3").innerHTML = num3
    document.getElementById("num4").innerHTML = num4
    document.getElementById("num5").innerHTML = num5
    document.getElementById("num6").innerHTML = num6
    document.getElementById("num7").innerHTML = num7
    document.getElementById("num8").innerHTML = num8
    document.getElementById("num9").innerHTML = num9


    document.getElementById("cell1").value = num1
    document.getElementById("cell2").value = num2
    document.getElementById("cell3").value = num3
    document.getElementById("cell4").value = num4
    document.getElementById("cell5").value = num5
    document.getElementById("cell6").value = num6
    document.getElementById("cell7").value = num7
    document.getElementById("cell8").value = num8
    document.getElementById("cell9").value = num9

    var targets1 = [56,108,56,92,91,152,79,104,96,112,53,100,100,107,143,127,145,145,170,68,
                    115,188,42,99,169,88,70,66,100,116]
    var k = 0
    var target = targets1.slice(k,k+1)

    document.getElementById("target").innerHTML = target

    var checkboxes = document.querySelectorAll("input[type=checkbox]");
    var check_button = document.getElementById("check_button");
    check_button.disabled = true

    function getChecked() {
        var checked = [];
        for (var i = 0; i < checkboxes.length; i++) {
            var checkbox = checkboxes[i];
            if (checkbox.checked) checked.push(checkbox.value);
        }
        return checked;
     }

    function cbChange(obj) {
        var instate = (obj.checked);
        var submitted = getChecked();
        if (instate && submitted.length > 2) {
            obj.checked = false;
            alert('You are only allowed to pick 2 numbers to sum up to the target number.')
        }
        else if (instate) {
            obj.checked = true
        }
        var submitted = getChecked();

        if (submitted.length != 2) {
            check_button.disabled = true
        }
        else {
            check_button.disabled = false
        }
    }



    check_button.addEventListener("click", function() {
       var checkedraw = getChecked();
       var checkedint = checkedraw.map(Number);
       var sum_answers = checkedint.reduce(function(a, b) { return a + b; }, 0);
       if (sum_answers == target) {
           score++;
       }
       task1_score.value = score;
       if (sum_answers == target) {
           new_task(move_on = 'Yes')
       }
       else {
           alert('Chosen numbers do not sum up to the target number. Try again.')
           new_task(move_on = 'No')
       }
    }
   );


    function new_task(move_on = 'Yes') {
        if (move_on == 'Yes') {
            j += 9;
            k += 1;
        }

        var num1 = matrices1.slice(j,j+1)
        var num2 = matrices1.slice(j+1,j+2)
        var num3 = matrices1.slice(j+2,j+3)
        var num4 = matrices1.slice(j+3,j+4)
        var num5 = matrices1.slice(j+4,j+5)
        var num6 = matrices1.slice(j+5,j+6)
        var num7 = matrices1.slice(j+6,j+7)
        var num8 = matrices1.slice(j+7,j+8)
        var num9 = matrices1.slice(j+8,j+9)

        document.getElementById("num1").innerHTML = num1
        document.getElementById("num2").innerHTML = num2
        document.getElementById("num3").innerHTML = num3
        document.getElementById("num4").innerHTML = num4
        document.getElementById("num5").innerHTML = num5
        document.getElementById("num6").innerHTML = num6
        document.getElementById("num7").innerHTML = num7
        document.getElementById("num8").innerHTML = num8
        document.getElementById("num9").innerHTML = num9

        document.getElementById("cell1").checked = false
        document.getElementById("cell2").checked = false
        document.getElementById("cell3").checked = false
        document.getElementById("cell4").checked = false
        document.getElementById("cell5").checked = false
        document.getElementById("cell6").checked = false
        document.getElementById("cell7").checked = false
        document.getElementById("cell8").checked = false
        document.getElementById("cell9").checked = false

        document.getElementById("cell1").value = num1
        document.getElementById("cell2").value = num2
        document.getElementById("cell3").value = num3
        document.getElementById("cell4").value = num4
        document.getElementById("cell5").value = num5
        document.getElementById("cell6").value = num6
        document.getElementById("cell7").value = num7
        document.getElementById("cell8").value = num8
        document.getElementById("cell9").value = num9

        target = targets1.slice(k, k+1)

        document.getElementById("target").innerHTML = target
        check_button.disabled = true

    }
</script>


{% endblock %}

