{% extends "global/Page.html" %}
{% load otree %}



{% block content %}
<h5><strong>Please find the two numbers that sum up to <i id="target"></i></strong></h5>

<style>
    table {
        width: 20%;
        margin-left: auto;
        margin-right: auto;
    }
    td {text-align: center;
        height: 50px;
    }
    .buttonHolder {
        text-align: center;
    }
    #content {
        position: absolute;
        top: 40px;
        right: 40px;
    }
</style>

<div class="QuestionDIV">
    <table>
        <tr>
            <td> <button type="button" id="btn1" class="btn btn-outline-primary" onclick="setAnswer(1, num1)"><div id="num1"></button>
            </td>
            <td> <button type="button" id="btn2" class="btn btn-outline-primary" onclick="setAnswer(2, num2)"><div id="num2"></button>
            </td>
            <td> <button type="button" id="btn3" class="btn btn-outline-primary" onclick="setAnswer(3, num3)"><div id="num3"></button>
            </td>
        </tr>
        <tr>
            <td> <button type="button" id="btn4" class="btn btn-outline-primary" onclick="setAnswer(4, num4)"><div id="num4"></button>
            </td>
            <td> <button type="button" id="btn5" class="btn btn-outline-primary" onclick="setAnswer(5, num5)"><div id="num5"></button>
            </td>
            <td> <button type="button" id="btn6" class="btn btn-outline-primary" onclick="setAnswer(6, num6)"><div id="num6"></button>
            </td>
        </tr>
         <tr>
            <td> <button type="button" id="btn7" class="btn btn-outline-primary" onclick="setAnswer(7, num7)"><div id="num7"></button>
            </td>
            <td> <button type="button" id="btn8" class="btn btn-outline-primary" onclick="setAnswer(8, num8)"><div id="num8"></button>
            </td>
            <td> <button type="button" id="btn9" class="btn btn-outline-primary" onclick="setAnswer(9, num9)"><div id="num9"></button>
            </td>
        </tr>
    </table>
    <p>
        <div class="buttonHolder">
            <input type="submit" class="btn btn-outline-primary" id="check_button" value="Submit" >
            <input type="hidden" name="nr_correct_1" id="Task1Correct" />
        </div>
    </p>
</div>

<div class="card" id="content">
  <div class="card-body">
      <b> Correctly soved tasks: <a id="current_score">0</a> </b>
  </div>
</div>

<script type="text/javascript">
    var task1_score = document.getElementById("Task1Correct");
	var score = 0
    var matrices1 = [21,22,36,28,39,45,98,75,93,
                    66,26,98,11,87,10,60,47,46,
                    30,90,14,28,55,29,86,54,74,
                    27,20,33,62,42,81,49,35,22,
                    98,81,89,87,33,42,17,75,32,
                    76,88,61,89,77,48,45,67,64,
                    96,95,88,94,89,78,16,28,59,
                    71,29,97,56,36,54,83,82,17,
                    44,32,77,36,55,35,17,79,65,
                    56,57,35,59,79,87,34,54,25,
                    60,28,48,11,26,75,10,80,58,
                    65,16,26,82,83,93,53,17,80,
                    52,32,61,60,71,12,51,69,55,
                    68,17,86,96,45,54,53,24,79,
                    87,77,88,25,19,59,20,54,43,
                    87,11,35,50,25,49,40,88,31,
                    30,75,11,94,92,48,33,82,13,
                    18,22,46,61,48,51,50,25,42,
                    57,55,82,97,95,45,47,71,14,
                    87,70,46,80,78,53,39,11,83,
                    52,26,53,80,18,29,88,25,14,
                    59,63,91,75,17,60,92,24,90,
                    86,55,93,58,38,68,90,51,16,
                    70,18,78,71,20,49,55,69,38,
                    50,97,73,23,19,48,26,68,25,
                    34,67,42,56,48,63,84,37,96,
                    45,53,57,52,33,59,30,16,46,
                    71,51,73,84,61,58,97,33,63,
                    56,79,88,11,35,81,57,24,84,
                    85,87,54,50,77,46,14,51,43,
                    54,32,39,75,44,35,23,21,67,
                    50,13,42,15,51,46,36,11,54,
                    29,86,64,27,76,18,72,60,91,
                    89,38,35,75,88,29,44,60,91,
                    21,69,13,52,59,17,28,82,74,
                    94,45,73,37,43,21,93,57,74,
                    24,85,46,11,92,82,93,38,90,
                    38,62,76,39,54,48,43,97,11,
                    97,31,93,40,67,26,20,44,12,
                    83,34,39,68,67,98,73,12,65,
                    62,17,61,34,21,86,97,54,16,
                    55,73,69,61,78,59,75,43,25,
                    78,67,44,32,74,75,53,72,58,
                    42,23,74,14,68,94,56,47,79,
                    21,84,12,75,42,74,87,82,18,
                    48,74,91,72,21,31,83,41,33,
                    39,67,79,19,23,90,22,25,20,
                    10,20,64,65,16,54,77,25,67,
                    82,53,78,75,67,87,79,65,72,
                    47,74,71,72,30,19,56,41,83,
                    10,16,81,34,64,44,17,26,89,
                    84,40,29,91,25,12,72,73,90,
                    21,57,41,52,54,40,91,79,42,
                    42,41,90,24,13,36,48,64,59,
                    93,87,95,47,71,26,37,98,64,
                    41,67,71,29,25,74,52,95,78,
                    20,72,76,81,64,21,19,90,79,
                    53,42,83,12,29,21,78,48,68,
                    29,98,94,56,21,10,30,35,85,
                    81,88,77,17,55,36,16,12,96]
    var j = 0

    var num1 = matrices1.slice(j,j+1)
    var num2 = matrices1.slice(j+1,j+2)
    var num3 = matrices1.slice(j+2,j+3)
    var num4 = matrices1.slice(j+3,j+4)
    var num5 = matrices1.slice(j+4,j+5)
    var num6 = matrices1.slice(j+5,j+6)
    var num7 = matrices1.slice(j+6,j+7)
    var num8 = matrices1.slice(j+7,j+8)
    var num9 = matrices1.slice(j+8,j+9)

    document.getElementById("num1").innerHTML = num1
    document.getElementById("num2").innerHTML = num2
    document.getElementById("num3").innerHTML = num3
    document.getElementById("num4").innerHTML = num4
    document.getElementById("num5").innerHTML = num5
    document.getElementById("num6").innerHTML = num6
    document.getElementById("num7").innerHTML = num7
    document.getElementById("num8").innerHTML = num8
    document.getElementById("num9").innerHTML = num9

    var targets1 = [81,145,120,84,92,136,184,110,72,94,135,108,106,165,78,74,78,68,139,98,47,123,109,67,
        98,180,87,121,165,97,79,47,155,179,97,138,136,114,119,141,103,136,102,115,93,69,115,97,140,75,
        60,131,148,95,108,149,157,107,56,100]

    var k = 0
    var target = targets1.slice(k,k+1)
    document.getElementById("target").innerHTML = target

    function removeClickedButton(arr, value) {
    var index = arr.indexOf(value);
    if (index > -1) {
      arr.splice(index, 1);
    }
    return arr;
    }

    var check_button = document.getElementById("check_button");
    check_button.disabled = true
    var clickedButtons = []
    var clickedNumbers = []

    function setClickedButtons() {
        for (i = 1; i <= 9; i++) {
            if (clickedButtons.includes(i)) {
                document.getElementById("btn" + i).className = 'btn btn-warning';
            }
            else {
                document.getElementById("btn" + i).className = 'btn btn-outline-primary';
            }
        }
    }

	function setAnswer(nr, number) {
        if (clickedButtons.includes(nr)) {
            clickedButtons = removeClickedButton(clickedButtons, nr);
            clickedNumbers = removeClickedButton(clickedNumbers, number);
        }
        else {
            if (clickedButtons.length < 2) {
                clickedButtons.push(nr);
                clickedNumbers.push(number);
            } else {
                alert("You are only allowed to pick 2 numbers to sum up to the target number.")
            }
        }
        setClickedButtons()

        if (clickedButtons.length != 2) {
            check_button.disabled = true;
        }
        else {
            check_button.disabled = false;
        }
    }

	check_button.addEventListener("click", function() {
    	var checkedint = clickedNumbers.map(Number);
	    var sum_answers = checkedint.reduce(function(a, b) { return a + b; }, 0);
	    if (sum_answers == target) {
        	score++;
        }
        task1_score.value = score;
        document.getElementById("current_score").innerHTML = task1_score.value;
        if (sum_answers == target) {
            new_task(move_on = 'Yes');
            clickedButtons = [];
            clickedNumbers = [];
            for (i = 1; i <= 9; i++) {
                document.getElementById("btn" + i).className = 'btn btn-outline-primary';
            }
        }
        else {
        	alert("Chosen numbers do not sum up to the target number. Try again." + sum_answers + "|" + clickedNumbers)
            new_task(move_on = 'No');
            clickedButtons = [];
            clickedNumbers = [];
            for (i = 1; i <= 9; i++) {
                document.getElementById("btn" + i).className = 'btn btn-outline-primary';
            }
		}
    });

    function new_task(move_on = 'Yes') {
        if (move_on == 'Yes') {
            j += 9;
            k += 1;
        }

        num1 = matrices1.slice(j,j+1)
        num2 = matrices1.slice(j+1,j+2)
        num3 = matrices1.slice(j+2,j+3)
        num4 = matrices1.slice(j+3,j+4)
        num5 = matrices1.slice(j+4,j+5)
        num6 = matrices1.slice(j+5,j+6)
        num7 = matrices1.slice(j+6,j+7)
        num8 = matrices1.slice(j+7,j+8)
        num9 = matrices1.slice(j+8,j+9)

        document.getElementById("num1").innerHTML = num1
        document.getElementById("num2").innerHTML = num2
        document.getElementById("num3").innerHTML = num3
        document.getElementById("num4").innerHTML = num4
        document.getElementById("num5").innerHTML = num5
        document.getElementById("num6").innerHTML = num6
        document.getElementById("num7").innerHTML = num7
        document.getElementById("num8").innerHTML = num8
        document.getElementById("num9").innerHTML = num9

        target = targets1.slice(k, k+1)

        document.getElementById("target").innerHTML = target
        check_button.disabled = true
    }

</script>

{% endblock %}

