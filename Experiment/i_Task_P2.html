{% extends "global/Page.html" %}
{% load otree %}

{% block title %}Task 1. Part 2: Finding the 2 Numbers forming a sum{% endblock %}

{% block content %}

<h5><strong>Please find the two numbers that sum up to <i id="target"></i></strong></h5>

<style>
    table {
        width: 60%;
        margin-left:auto;
        margin-right:auto;
        border: 2px solid rgb(36, 126, 243);
        /*border-collapse: collapse;*/
    }
    th, td {
        text-align: center;
        height: 50px;
        border: 2px solid rgb(36, 126, 243);
        border-collapse: collapse;
    }
    td:hover {
        background-color: azure;
    }
    .buttonHolder{
        text-align: center;
    }
</style>

<div class="QuestionDIV">
    <table>
        <tr>
            <td> <input type="checkbox" id="cell1" name="number" onchange="cbChange(this)">
                 <label for="cell1" id="num1"></label>
            </td>
            <td> <input type="checkbox" id="cell2" name="number" onchange="cbChange(this)">
                 <label for="cell2" id="num2"></label>
            </td>
            <td> <input type="checkbox" id="cell3" name="number" onchange="cbChange(this)">
                 <label for="cell3" id="num3"></label>
            </td>
        </tr>
        <tr>
            <td> <input type="checkbox" id="cell4" name="number" onchange="cbChange(this)">
                 <label for="cell4" id="num4"></label>
            </td>
            <td> <input type="checkbox" id="cell5" name="number" onchange="cbChange(this)">
                 <label for="cell5" id="num5"></label>
            </td>
            <td> <input type="checkbox" id="cell6" name="number" onchange="cbChange(this)">
                 <label for="cell6" id="num6"></label>
            </td>
        </tr>
        <tr>
            <td> <input type="checkbox" id="cell7" name="number" onchange="cbChange(this)">
                 <label for="cell7" id="num7"></label>
            </td>
            <td> <input type="checkbox" id="cell8" name="number" onchange="cbChange(this)">
                 <label for="cell8" id="num8"></label>
            </td>
            <td> <input type="checkbox" id="cell9" name="number" onchange="cbChange(this)">
                 <label for="cell9" id="num9"></label>
            </td>
        </tr>
    </table>
    <p>
        <div class="buttonHolder">
            <input type="submit" id="check_button" value="Submit" >
            <input type="hidden" name="nr_correct_2" id="Task2Correct" />
        </div>
    </p>
</div>


<script type="text/javascript">
    var score = 0
    var task2_score = document.getElementById("Task2Correct");

    var matrices2 =[94,28,25,41,13,58,52,59,46,
                    86,83,32,58,21,52,37,92,15,
                    94,51,64,52,12,49,16,76,70,
                    79,24,77,73,37,23,55,22,26,
                    23,69,66,20,84,18,83,62,53,
                    19,63,94,69,72,66,51,29,25,
                    33,12,58,96,79,16,20,60,92,
                    30,33,52,77,54,31,59,68,39,
                    89,61,43,75,91,74,88,46,53,
                    29,22,35,86,57,30,90,72,55,
                    16,94,58,17,98,46,59,13,64,
                    50,27,87,96,13,28,20,61,70,
                    19,42,92,13,41,33,21,39,81,
                    95,10,86,22,33,21,28,97,51,
                    64,17,46,93,13,42,18,56,80,
                    70,19,18,37,29,77,39,21,14,
                    44,12,40,24,83,84,72,11,22,
                    93,30,58,67,11,40,83,71,94,
                    72,42,58,29,38,59,43,89,28,
                    95,75,96,20,32,68,30,94,25,
                    77,73,96,41,48,20,67,80,33,
                    20,68,83,69,26,55,73,40,37,
                    91,13,48,17,74,77,76,86,83,
                    29,82,17,36,80,46,94,69,35,
                    28,26,53,77,14,20,66,49,62,
                    33,50,85,98,87,91,16,72,81,
                    60,65,27,53,51,29,20,12,62,
                    18,52,41,76,14,73,48,87,88,
                    72,76,80,12,54,26,34,47,65,
                    72,65,42,73,92,21,44,38,54,
                    79,66,57,35,10,46,71,37,15,
                    68,81,98,34,28,36,87,26,16,
                    59,76,77,46,44,92,34,53,60,
                    96,52,39,54,78,93,75,62,14,
                    10,77,75,38,40,33,64,39,35,
                    86,79,36,69,10,89,33,60,19,
                    55,46,53,72,69,85,65,36,49,
                    39,82,37,10,93,18,52,47,97,
                    15,51,27,88,65,30,38,55,26,
                    42,60,47,83,39,49,88,72,27,
                    72,85,78,24,45,95,64,51,38,
                    43,60,87,36,90,30,37,40,76,
                    55,22,11,19,71,90,79,41,66,
                    79,64,76,97,26,81,96,61,11,
                    44,17,68,28,22,94,69,88,92]

    var j = 0

    var num1 = matrices2.slice(j,j+1)
    var num2 = matrices2.slice(j+1,j+2)
    var num3 = matrices2.slice(j+2,j+3)
    var num4 = matrices2.slice(j+3,j+4)
    var num5 = matrices2.slice(j+4,j+5)
    var num6 = matrices2.slice(j+5,j+6)
    var num7 = matrices2.slice(j+6,j+7)
    var num8 = matrices2.slice(j+7,j+8)
    var num9 = matrices2.slice(j+8,j+9)


    document.getElementById("num1").innerHTML = num1
    document.getElementById("num2").innerHTML = num2
    document.getElementById("num3").innerHTML = num3
    document.getElementById("num4").innerHTML = num4
    document.getElementById("num5").innerHTML = num5
    document.getElementById("num6").innerHTML = num6
    document.getElementById("num7").innerHTML = num7
    document.getElementById("num8").innerHTML = num8
    document.getElementById("num9").innerHTML = num9


    document.getElementById("cell1").value = num1
    document.getElementById("cell2").value = num2
    document.getElementById("cell3").value = num3
    document.getElementById("cell4").value = num4
    document.getElementById("cell5").value = num5
    document.getElementById("cell6").value = num6
    document.getElementById("cell7").value = num7
    document.getElementById("cell8").value = num8
    document.getElementById("cell9").value = num9

    var targets2 = [110,113,110,156,73,166,112,107,131,64,111,116,74,116,139,58,34,78,132,124,153,110,
        94,118,86,124,104,91,126,86,112,103,105,158,108,29,101,62,118,66,157,67,161,175,72]
    var k = 0
    var target = targets2.slice(k,k+1)

    document.getElementById("target").innerHTML = target

    var checkboxes = document.querySelectorAll("input[type=checkbox]");
    var check_button = document.getElementById("check_button");
    check_button.disabled = true

    function getChecked() {
        var checked = [];
        for (var i = 0; i < checkboxes.length; i++) {
            var checkbox = checkboxes[i];
            if (checkbox.checked) checked.push(checkbox.value);
        }
        return checked;
     }

    function cbChange(obj) {
        var instate = (obj.checked);
        var submitted = getChecked();
        if (instate && submitted.length > 2) {
            obj.checked = false;
            alert('You are only allowed to pick 2 numbers to sum up to the target number.')
        }
        else if (instate) {
            obj.checked = true
        }
        var submitted = getChecked();

        if (submitted.length != 2) {
            check_button.disabled = true
        }
        else {
            check_button.disabled = false
        }
    }

    check_button.addEventListener("click", function() {
       var checkedraw = getChecked();
       var checkedint = checkedraw.map(Number);
       var sum_answers = checkedint.reduce(function(a, b) { return a + b; }, 0);
       if (sum_answers == target) {
           score++;
       }
       task2_score.value = score;
       if (sum_answers == target) {
           new_task(move_on = 'Yes')
       }
       else {
           alert('Chosen numbers do not sum up to the target number. Try again.')
           new_task(move_on = 'No')
       }
    }
   );


    function new_task(move_on = 'Yes') {
        if (move_on == 'Yes') {
            j += 9;
            k += 1;
        }

        var num1 = matrices2.slice(j,j+1)
        var num2 = matrices2.slice(j+1,j+2)
        var num3 = matrices2.slice(j+2,j+3)
        var num4 = matrices2.slice(j+3,j+4)
        var num5 = matrices2.slice(j+4,j+5)
        var num6 = matrices2.slice(j+5,j+6)
        var num7 = matrices2.slice(j+6,j+7)
        var num8 = matrices2.slice(j+7,j+8)
        var num9 = matrices2.slice(j+8,j+9)

        document.getElementById("num1").innerHTML = num1
        document.getElementById("num2").innerHTML = num2
        document.getElementById("num3").innerHTML = num3
        document.getElementById("num4").innerHTML = num4
        document.getElementById("num5").innerHTML = num5
        document.getElementById("num6").innerHTML = num6
        document.getElementById("num7").innerHTML = num7
        document.getElementById("num8").innerHTML = num8
        document.getElementById("num9").innerHTML = num9

        document.getElementById("cell1").checked = false
        document.getElementById("cell2").checked = false
        document.getElementById("cell3").checked = false
        document.getElementById("cell4").checked = false
        document.getElementById("cell5").checked = false
        document.getElementById("cell6").checked = false
        document.getElementById("cell7").checked = false
        document.getElementById("cell8").checked = false
        document.getElementById("cell9").checked = false

        document.getElementById("cell1").value = num1
        document.getElementById("cell2").value = num2
        document.getElementById("cell3").value = num3
        document.getElementById("cell4").value = num4
        document.getElementById("cell5").value = num5
        document.getElementById("cell6").value = num6
        document.getElementById("cell7").value = num7
        document.getElementById("cell8").value = num8
        document.getElementById("cell9").value = num9

        target = targets2.slice(k,k+1)

        document.getElementById("target").innerHTML = target
        check_button.disabled = true

    }
</script>


{% endblock %}

