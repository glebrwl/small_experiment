{% extends "global/Page.html" %}
{% load otree %}



{% block content %}
<h5><strong>Please find the two numbers that sum up to <i id="target"></i></strong></h5>

<style>
    table {
        width: 20%;
        margin-left: auto;
        margin-right: auto;
    }
    td {text-align: center;
        height: 50px;
    }
    .buttonHolder {
        text-align: center;
    }
    #content {
        position: absolute;
        top: 40px;
        right: 40px;
    }
</style>

<div class="QuestionDIV">
    <table>
        <tr>
            <td> <button type="button" id="btn1" class="btn btn-outline-primary" onclick="setAnswer(1, num1)"><div id="num1"></button>
            </td>
            <td> <button type="button" id="btn2" class="btn btn-outline-primary" onclick="setAnswer(2, num2)"><div id="num2"></button>
            </td>
            <td> <button type="button" id="btn3" class="btn btn-outline-primary" onclick="setAnswer(3, num3)"><div id="num3"></button>
            </td>
        </tr>
        <tr>
            <td> <button type="button" id="btn4" class="btn btn-outline-primary" onclick="setAnswer(4, num4)"><div id="num4"></button>
            </td>
            <td> <button type="button" id="btn5" class="btn btn-outline-primary" onclick="setAnswer(5, num5)"><div id="num5"></button>
            </td>
            <td> <button type="button" id="btn6" class="btn btn-outline-primary" onclick="setAnswer(6, num6)"><div id="num6"></button>
            </td>
        </tr>
         <tr>
            <td> <button type="button" id="btn7" class="btn btn-outline-primary" onclick="setAnswer(7, num7)"><div id="num7"></button>
            </td>
            <td> <button type="button" id="btn8" class="btn btn-outline-primary" onclick="setAnswer(8, num8)"><div id="num8"></button>
            </td>
            <td> <button type="button" id="btn9" class="btn btn-outline-primary" onclick="setAnswer(9, num9)"><div id="num9"></button>
            </td>
        </tr>
    </table>
    <p>
        <div class="buttonHolder">
            <input type="submit" class="btn btn-outline-primary" id="check_button" value="Submit" >
            <input type="hidden" name="nr_correct_2" id="Task2Correct" />
        </div>
    </p>
</div>

<div class="card" id="content">
  <div class="card-body">
      <b> Correctly soved tasks: <a id="current_score">0</a> </b>
  </div>
</div>

<script type="text/javascript">
    var task2_score = document.getElementById("Task2Correct");
	var score = 0
    var matrices2 = [82,86,51,39,87,44,17,23,85,
                    83,84,41,52,69,88,16,65,20,
                    40,83,66,90,48,19,46,87,85,
                    78,69,43,19,14,65,77,13,31,
                    49,86,23,21,70,59,25,64,93,
                    55,48,51,54,71,20,22,30,74,
                    49,11,72,52,32,33,96,61,16,
                    74,20,85,70,37,61,67,53,95,
                    73,60,45,27,17,79,14,74,58,
                    63,12,94,18,42,91,29,38,59,
                    66,35,94,37,87,32,75,88,38,
                    91,87,90,69,57,25,56,47,50,
                    63,51,89,20,90,58,46,79,22,
                    48,69,31,79,13,94,64,58,42,
                    57,50,11,34,28,87,75,94,41,
                    37,48,16,77,67,98,78,23,43,
                    45,67,55,50,22,47,21,44,54,
                    23,79,94,87,81,89,45,60,35,
                    89,27,12,39,38,73,33,13,95,
                    67,32,34,75,51,10,91,45,70,
                    17,85,97,10,57,83,28,92,14,
                    81,67,82,17,86,39,51,88,30,
                    63,28,72,40,41,68,22,46,75,
                    84,70,25,98,32,71,46,21,72,
                    12,16,91,17,69,54,20,27,42,
                    90,26,56,82,63,79,51,95,43,
                    47,40,86,45,57,64,42,48,75,
                    66,67,84,25,32,42,95,65,51,
                    17,26,16,11,33,21,18,41,67,
                    24,92,79,47,45,90,46,95,11,
                    98,82,93,74,43,92,71,17,26,
                    98,77,33,92,72,94,40,79,37,
                    68,14,54,15,76,19,44,74,89,
                    70,28,84,42,11,29,40,47,55,
                    95,31,61,45,65,62,57,82,18,
                    89,86,96,36,54,91,10,74,69,
                    59,48,88,72,12,92,35,64,81,
                    70,44,24,30,77,22,13,55,73,
                    20,97,68,40,84,73,89,67,79,
                    32,33,92,87,73,51,44,86,19,
                    43,13,66,30,41,38,94,85,83,
                    85,65,88,71,54,51,23,93,33,
                    34,61,44,11,93,70,52,18,89,
                    65,40,94,53,11,82,92,76,15,
                    28,55,11,94,22,83,61,17,91,
                    94,57,21,18,25,96,11,73,53,
                    84,70,17,16,45,28,67,79,27,
                    77,65,81,96,23,93,51,32,44,
                    16,97,83,23,35,29,49,94,76,
                    26,84,72,53,42,50,60,33,89,
                    13,11,96,79,52,87,73,23,26,
                    24,36,86,21,81,20,32,83,54,
                    27,36,26,35,79,55,14,19,63,
                    16,65,47,44,57,85,26,66,68,
                    22,46,83,40,68,37,58,78,91,
                    59,42,46,70,93,84,32,49,12,
                    67,46,35,73,97,68,55,81,37,
                    87,44,23,65,56,26,14,89,66,
                    61,69,11,65,89,22,66,36,13,
                    96,43,65,42,63,81,41,58,70]
    var j = 0

    var num1 = matrices2.slice(j,j+1)
    var num2 = matrices2.slice(j+1,j+2)
    var num3 = matrices2.slice(j+2,j+3)
    var num4 = matrices2.slice(j+3,j+4)
    var num5 = matrices2.slice(j+4,j+5)
    var num6 = matrices2.slice(j+5,j+6)
    var num7 = matrices2.slice(j+6,j+7)
    var num8 = matrices2.slice(j+7,j+8)
    var num9 = matrices2.slice(j+8,j+9)

    document.getElementById("num1").innerHTML = num1
    document.getElementById("num2").innerHTML = num2
    document.getElementById("num3").innerHTML = num3
    document.getElementById("num4").innerHTML = num4
    document.getElementById("num5").innerHTML = num5
    document.getElementById("num6").innerHTML = num6
    document.getElementById("num7").innerHTML = num7
    document.getElementById("num8").innerHTML = num8
    document.getElementById("num9").innerHTML = num9

    var targets2 = [104,85,130,100,145,102,82,123,44,54,154,107,85,152,75,155,99,181,168,115,
        180,118,112,97,86,121,82,92,33,141,117,132,34,113,106,155,123,86,107,84,168,139,63,134,116,
        130,100,88,65,117,99,52,118,150,124,74,128,89,158,144]
    var k = 0
    var target = targets2.slice(k,k+1)
    document.getElementById("target").innerHTML = target

    function removeClickedButton(arr, value) {
    var index = arr.indexOf(value);
    if (index > -1) {
      arr.splice(index, 1);
    }
    return arr;
    }

    var check_button = document.getElementById("check_button");
    check_button.disabled = true
    var clickedButtons = []
    var clickedNumbers = []

    function setClickedButtons() {
        for (i = 1; i <= 9; i++) {
            if (clickedButtons.includes(i)) {
                document.getElementById("btn" + i).className = 'btn btn-warning';
            }
            else {
                document.getElementById("btn" + i).className = 'btn btn-outline-primary';
            }
        }
    }

	function setAnswer(nr, number) {
        if (clickedButtons.includes(nr)) {
            clickedButtons = removeClickedButton(clickedButtons, nr);
            clickedNumbers = removeClickedButton(clickedNumbers, number);
        }
        else {
            if (clickedButtons.length < 2) {
                clickedButtons.push(nr);
                clickedNumbers.push(number);
            } else {
                alert("You are only allowed to pick 2 numbers to sum up to the target number.")
            }
        }
        setClickedButtons()

        if (clickedButtons.length != 2) {
            check_button.disabled = true;
        }
        else {
            check_button.disabled = false;
        }
    }

	check_button.addEventListener("click", function() {
    	var checkedint = clickedNumbers.map(Number);
	    var sum_answers = checkedint.reduce(function(a, b) { return a + b; }, 0);
	    if (sum_answers == target) {
        	score++;
        }
        task2_score.value = score;
        document.getElementById("current_score").innerHTML = task2_score.value;
        if (sum_answers == target) {
            new_task(move_on = 'Yes');
            clickedButtons = [];
            clickedNumbers = [];
            for (i = 1; i <= 9; i++) {
                document.getElementById("btn" + i).className = 'btn btn-outline-primary';
            }
        }
        else {
        	alert("Chosen numbers do not sum up to the target number. Try again.")
            new_task(move_on = 'No')
		}
    });

    function new_task(move_on = 'Yes') {
        if (move_on == 'Yes') {
            j += 9;
            k += 1;
        }

        num1 = matrices2.slice(j,j+1)
        num2 = matrices2.slice(j+1,j+2)
        num3 = matrices2.slice(j+2,j+3)
        num4 = matrices2.slice(j+3,j+4)
        num5 = matrices2.slice(j+4,j+5)
        num6 = matrices2.slice(j+5,j+6)
        num7 = matrices2.slice(j+6,j+7)
        num8 = matrices2.slice(j+7,j+8)
        num9 = matrices2.slice(j+8,j+9)

        document.getElementById("num1").innerHTML = num1
        document.getElementById("num2").innerHTML = num2
        document.getElementById("num3").innerHTML = num3
        document.getElementById("num4").innerHTML = num4
        document.getElementById("num5").innerHTML = num5
        document.getElementById("num6").innerHTML = num6
        document.getElementById("num7").innerHTML = num7
        document.getElementById("num8").innerHTML = num8
        document.getElementById("num9").innerHTML = num9

        target = targets2.slice(k, k+1)

        document.getElementById("target").innerHTML = target
        check_button.disabled = true
    }

</script>

{% endblock %}

